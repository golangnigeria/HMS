{{template "base" .}} 

{{define "title"}}Patient's Registration - KiLab{{end}}

{{define "css"}}
<link
  href="https://cdn.jsdelivr.net/npm/remixicon@4.5.0/fonts/remixicon.css"
  rel="stylesheet"
/>
{{end}}

{{define "content"}}
<main class="min-h-screen flex items-center justify-center py-12 px-4 bg-gray-50 dark:bg-background-dark">
  <div class="w-full max-w-xl">
    <div
      class="backdrop-blur-xl bg-white/80 dark:bg-background-dark/70 border border-gray-200 dark:border-gray-700 rounded-2xl shadow-xl p-8"
      x-data="patientForm()"
      x-init="init()"
    >
      <!-- Header -->
      <div class="text-center mb-10">
        <h2 class="text-3xl font-extrabold text-gray-900 dark:text-white">
          Patient Registration
        </h2>
        <p class="text-gray-600 dark:text-gray-400 mt-2 text-sm">
          Fill in your details to create a secure patient account.
        </p>
      </div>

      <!-- Form -->
      <form class="space-y-6" @submit.prevent="submitForm">
        <!-- Full Name -->
        <div>
          <label class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1" for="full-name">Full Name</label>
          <input
            id="full-name"
            type="text"
            placeholder="e.g. Jane Doe"
            x-model="form.fullName"
            @blur="validateField('fullName')"
            class="w-full rounded-lg border border-gray-300 dark:border-gray-600 px-4 py-3 bg-white dark:bg-content-dark/60 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:outline-none"
          />
          <p class="text-red-500 text-xs mt-1" x-text="errors.fullName"></p>
        </div>

        <!-- Email -->
        <div>
          <label class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1" for="email">Email Address</label>
          <input
            id="email"
            type="email"
            placeholder="you@example.com"
            x-model="form.email"
            @blur="validateField('email')"
            class="w-full rounded-lg border border-gray-300 dark:border-gray-600 px-4 py-3 bg-white dark:bg-content-dark/60 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:outline-none"
          />
          <p class="text-red-500 text-xs mt-1" x-text="errors.email"></p>
        </div>

        <!-- Phone + DOB -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div>
            <label class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1" for="phone">Phone Number</label>
            <input
              id="phone"
              type="tel"
              placeholder="+234 800 123 4567"
              x-model="form.phone"
              @blur="validateField('phone')"
              class="w-full rounded-lg border border-gray-300 dark:border-gray-600 px-4 py-3 bg-white dark:bg-content-dark/60 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:outline-none"
            />
            <p class="text-red-500 text-xs mt-1" x-text="errors.phone"></p>
          </div>
          <div>
            <label class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1" for="dob">Date of Birth</label>
            <input
              id="dob"
              type="date"
              x-model="form.dob"
              @blur="validateField('dob')"
              class="w-full rounded-lg border border-gray-300 dark:border-gray-600 px-4 py-3 bg-white dark:bg-content-dark/60 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:outline-none"
            />
            <p class="text-red-500 text-xs mt-1" x-text="errors.dob"></p>
          </div>
        </div>

        <!-- Gender -->
        <div>
          <label class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1" for="gender">Gender</label>
          <select
            id="gender"
            x-model="form.gender"
            @blur="validateField('gender')"
            class="w-full rounded-lg border border-gray-300 dark:border-gray-600 px-4 py-3 bg-white dark:bg-content-dark/60 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:outline-none"
          >
            <option disabled selected value="">Select Gender</option>
            <option>Male</option>
            <option>Female</option>
            <option>Other</option>
            <option>Prefer not to say</option>
          </select>
          <p class="text-red-500 text-xs mt-1" x-text="errors.gender"></p>
        </div>

        <!-- Password -->
        <div class="relative">
          <label class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1" for="password">Password</label>
          <input
            id="password"
            :type="showPassword ? 'text' : 'password'"
            placeholder="Create a strong password"
            x-model="form.password"
            @blur="validateField('password')"
            class="w-full rounded-lg border border-gray-300 dark:border-gray-600 px-4 py-3 pr-12 bg-white dark:bg-content-dark/60 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:outline-none"
          />
          <button
            type="button"
            @click="showPassword = !showPassword"
            class="absolute right-3 top-10 text-gray-400 hover:text-primary"
          >
            <i :class="showPassword ? 'ri-eye-off-line' : 'ri-eye-line'"></i>
          </button>
          <p class="text-red-500 text-xs mt-1" x-text="errors.password"></p>
        </div>

        <!-- Confirm Password -->
        <div class="relative">
          <label class="block text-sm font-semibold text-gray-700 dark:text-gray-300 mb-1" for="confirm-password">Confirm Password</label>
          <input
            id="confirm-password"
            :type="showConfirm ? 'text' : 'password'"
            placeholder="Re-enter your password"
            x-model="form.confirmPassword"
            @blur="validateField('confirmPassword')"
            class="w-full rounded-lg border border-gray-300 dark:border-gray-600 px-4 py-3 pr-12 bg-white dark:bg-content-dark/60 text-gray-900 dark:text-white focus:ring-2 focus:ring-primary focus:outline-none"
          />
          <button
            type="button"
            @click="showConfirm = !showConfirm"
            class="absolute right-3 top-10 text-gray-400 hover:text-primary"
          >
            <i :class="showConfirm ? 'ri-eye-off-line' : 'ri-eye-line'"></i>
          </button>
          <p class="text-red-500 text-xs mt-1" x-text="errors.confirmPassword"></p>
        </div>

        <!-- Terms -->
        <div class="flex items-start gap-2">
          <input type="checkbox" x-model="form.agreed" class="mt-1 h-4 w-4 text-primary rounded border-gray-300 focus:ring-primary" />
          <label class="text-sm text-gray-600 dark:text-gray-300">
            I agree to the <a href="#" class="font-semibold text-primary hover:underline">Terms of Service</a> and 
            <a href="#" class="font-semibold text-primary hover:underline">Privacy Policy</a>.
          </label>
        </div>
        <p class="text-red-500 text-xs mt-1" x-text="errors.agreed"></p>

        <!-- Submit -->
        <div class="pt-4">
          <button
            type="submit"
            :disabled="loading"
            class="w-full rounded-lg h-12 px-5 bg-primary text-white text-base font-bold tracking-wide hover:bg-primary/90 transition disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center"
          >
            <span x-show="!loading">Register</span>
            <span x-show="loading" class="flex items-center gap-2">
              <i class="ri-loader-4-line animate-spin"></i> Processing...
            </span>
          </button>
        </div>
      </form>
       <p
      class="mt-6 text-center text-sm text-background-dark/60 dark:text-background-light/60"
    >
      Already have an account?
      <a class="font-medium text-primary hover:text-primary/80" href="/registration/role/patient"
        >Login</a
      >
    </p>
    </div>
  </div>
</main>
{{end}}

 
{{define "scripts"}}
<script>
function patientForm() {
  return {
    form: {
      fullName: '',
      email: '',
      phone: '',
      dob: '',
      gender: '',
      password: '',
      confirmPassword: '',
      agreed: false
    },
    errors: {},
    showPassword: false,
    showConfirm: false,
    loading: false,

    init() {
      this.errors = {};
    },

    validateField(field) {
      switch(field) {
        case 'fullName':
          this.errors.fullName = this.form.fullName.length < 3 ? 'Full name is required' : '';
          break;
        case 'email':
          this.errors.email = !/^[^@]+@[^@]+\.[^@]+$/.test(this.form.email) ? 'Invalid email address' : '';
          break;
        case 'phone':
          this.errors.phone = this.form.phone.length < 10 ? 'Enter a valid phone number' : '';
          break;
        case 'dob':
          this.errors.dob = this.form.dob === '' ? 'Date of birth is required' : '';
          break;
        case 'gender':
          this.errors.gender = this.form.gender === '' ? 'Please select gender' : '';
          break;
        case 'password':
          this.errors.password = this.form.password.length < 6 ? 'Password must be at least 6 characters' : '';
          break;
        case 'confirmPassword':
          this.errors.confirmPassword = this.form.confirmPassword !== this.form.password ? 'Passwords do not match' : '';
          break;
        case 'agreed':
          this.errors.agreed = !this.form.agreed ? 'You must agree before continuing' : '';
          break;
      }
    },

    submitForm() {
      Object.keys(this.form).forEach(f => this.validateField(f));
      if (Object.values(this.errors).some(e => e !== '')) return;
      this.loading = true;
      setTimeout(() => {
        this.loading = false;
        alert('Patient Registered Successfully âœ…');
      }, 2000);
    }
  }
}
</script>

{{end}}
